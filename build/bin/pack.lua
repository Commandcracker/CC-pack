local function a(b)if b==nil then else if term.isColor()then term.setTextColour(colors.orange)end;term.write(b.."? [")if term.isColor()then term.setTextColour(colors.lime)end;term.write('Y')if term.isColor()then term.setTextColour(colors.orange)end;term.write('/')if term.isColor()then term.setTextColour(colors.red)end;term.write('n')if term.isColor()then term.setTextColour(colors.orange)end;term.write("] ")term.setTextColour(colors.white)end;local c=string.lower(string.sub(read(),1,1))if c=='y'or c=='j'or c==''then return true else return false end end;local d=dofile("/"..fs.getDir(shell.getRunningProgram()).."/../".."lib/pack")d.fixSources(true)local function e()for f,g in pairs(d.getPackages())do for h,i in pairs(g)do term.setTextColour(colours.lightGrey)write(f)term.setTextColour(colours.grey)write("/")term.setTextColour(colors.white)print(h)end end end;local function j(k)if not k[2]then printError("Usage: show <package>")return end;for f,g in pairs(d.getPackages())do for h,l in pairs(g)do if h==k[2]then if term.isColor()then term.setTextColour(colors.orange)end;write("Package: ")if term.isColor()then term.setTextColour(colors.white)end;print(h)if term.isColor()then term.setTextColour(colors.orange)end;write("Url: ")if term.isColor()then if l["url"]then term.setTextColour(colors.blue)else term.setTextColour(colors.red)end end;print(l["url"])if term.isColor()then term.setTextColour(colors.orange)end;write("Installed: ")local m=d.isPackageInstalled(f.."/"..h)if term.isColor()then if m then term.setTextColour(colors.lime)else term.setTextColour(colors.red)end end;print(d.isPackageInstalled(f.."/"..h))term.setTextColour(colors.white)return end end end;printError("Package not found")end;local function n(k)if not k[2]then printError("Usage: search <package>")return end;local o=false;for f,g in pairs(d.getPackages())do for h,i in pairs(g)do if string.match(h,k[2])then term.setTextColour(colours.lightGrey)write(f)term.setTextColour(colours.grey)write("/")term.setTextColour(colors.white)print(h)o=true end end end;if not o then printError("No matching packages found")end end;local function p(k)if not k[2]then printError("Usage: install <package>")return end;for f,g in pairs(d.getPackages())do for h,l in pairs(g)do if h==k[2]then if d.isPackageInstalled(f.."/"..h)then printError("Package already installed")return end;if a("install "..f.."/"..h)then d.installPackage(f.."/"..h,l,shell)end;return end end end;printError("Package not found")end;local function q(k)if not k[2]then printError("Usage: remove <package>")return end;for f,g in pairs(d.getPackages())do for h,l in pairs(g)do if h==k[2]then if not d.isPackageInstalled(f.."/"..h)then printError("Package not installed")return end;if a("remove "..f.."/"..h)then d.removePackage(f.."/"..h)end;return end end end;printError("Package not found")end;local function r(k)if not k[3]then printError("Usage: add-source <name> <url>")return end;d.addSource(k[2],k[3],true)end;local function s()d.fetchSources(true)end;local t={{"install","install packages",p},{"show","show package details",j},{"search","search in package descriptions",n},{"remove","remove packages",q},{"list","list packages based on package names",e},{"fetch","updats the sources",s},{"add-source","add asorce to the sources file",r}}local function u()print("commands:")for i,v in pairs(t)do print("  "..v[1].." - "..v[2])end end;local k={...}if#k<=0 then print("Usage: pack <command>")u()return end;for i,v in pairs(t)do if k[1]==v[1]then v[3](k)return end end;printError("Command not found!")u()